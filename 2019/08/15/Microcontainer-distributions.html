<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Microcontainer distributions</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://malys.github.io/favicon.ico">

    <script type="text/javascript" src="//malys.github.io/themes/ichi_custom/assets/js/vendor/fastclick.js?v=1565615330365"></script>
    <script type="text/javascript" src="//malys.github.io/themes/ichi_custom/assets/js/vendor/modernizr.js?v=1565615330365"></script>

    <!--[if lte IE 8]>
        <link rel="stylesheet" type="text/css" href="//malys.github.io/themes/ichi_custom/assets/css/outdatedBrowser/outdatedBrowser.min.css?v=1565615330365">
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="//malys.github.io/themes/ichi_custom/assets/css/ichi.css?v=1565615330365" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:300,700,400|Source+Sans+Pro:300,400,600,700,900,300italic,400italic,600italic,700italic,900italic" />

    <link rel="canonical" href="https://malys.github.io/2019/08/15/Microcontainer-distributions.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Des outils et des développeurs..." />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Microcontainer distributions" />
    <meta property="og:description" content="Goal Container must include minimal dependencies to run Java application (microservice or legacy application). Sizing Creating a minimalist image will decrease size and improve performance to download it. It will also limit disk storage on docker registry and docker host (Layer duplication, automatic pull of base image). The same service" />
    <meta property="og:url" content="https://malys.github.io/2019/08/15/Microcontainer-distributions.html" />
    <meta property="article:published_time" content="2019-08-15T00:00:00.000Z" />
    <meta property="article:tag" content="optimization" />
    <meta property="article:tag" content="java" />
    <meta property="article:tag" content="microcontainer" />
    <meta property="article:tag" content="comparatif" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Microcontainer distributions" />
    <meta name="twitter:description" content="Goal Container must include minimal dependencies to run Java application (microservice or legacy application). Sizing Creating a minimalist image will decrease size and improve performance to download it. It will also limit disk storage on docker registry and docker host (Layer duplication, automatic pull of base image). The same service" />
    <meta name="twitter:url" content="https://malys.github.io/2019/08/15/Microcontainer-distributions.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Des outils et des développeurs...",
    "author": {
        "@type": "Person",
        "name": "Malys",
        "image": "https://avatars1.githubusercontent.com/u/463016?v=4",
        "url": "https://malys.github.io/author/malys/",
        "sameAs": "https://malys.github.io/"
    },
    "headline": "Microcontainer distributions",
    "url": "https://malys.github.io/2019/08/15/Microcontainer-distributions.html",
    "datePublished": "2019-08-15T00:00:00.000Z",
    "keywords": "optimization, java, microcontainer, comparatif",
    "description": "Goal Container must include minimal dependencies to run Java application (microservice or legacy application). Sizing Creating a minimalist image will decrease size and improve performance to download it. It will also limit disk storage on docker registry and docker host (Layer duplication, automatic pull of base image). The same service"
}
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Des outils et des développeurs..." href="https://malys.github.io/rss/" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism-okaidia.min.css">
    
        <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
</head>
<body class="post-template tag-optimization tag-java tag-microcontainer tag-comparatif">

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdate" href="http://outdatedbrowser.com/">Update my browser now</a></p>
</div>

<nav class="top-bar hide-for-large-up" data-topbar style="background: none">
  <ul class="title-area">
    <li class="name">
      
    </li>
    <li class="home"><a class="fi-home" href="https://malys.github.io"></a></li>
    <li class="toggle-topbar"><a href="#" id="trigger-overlay" class="fi-list"></a></li>
  </ul>

<div class="overlay overlay-scale">
    <button type="button" class="overlay-close">Close</button>
    <nav>
        <ul>
            
        </ul>
    </nav>
</div>

</nav>

<div class="row">

<div class="small-16 medium-16 large-4 columns head-area bgimage" style="background-image: url(https://malys.github.io/images/Eco-Innovation.jpeg)">

<header class="site-head">
    <div class="vertical">
        <div class="site-head-content inner">
            <ul class="side-nav blog-menu show-for-large-up">
                
            </ul>
            <a class="blog-logo" href="https://malys.github.io"><img alt="Des outils et des développeurs..." src="https://www.gravatar.com/avatar/c738c1bff9731c9cf6dccd5cc1270e94.png" alt="Blog Logo" /></a>
            <h1 class="blog-title">Des outils et des développeurs...</h1>
            <hr>
            <p class="blog-description">Astuces et conseils concernant les outils qui peuvent égailler le quotidien d&#x27;un développeur :)

</p>
            <div class="blog-network">
<!--                 <a href="#" class="fi-social-pinterest"></a>
                <a href="#" class="fi-social-linkedin"></a>
                <a href="#" class="fi-social-behance"></a>
                <a href="#" class="fi-social-deviant-art"></a>
                <a href="#" class="fi-social-dribbble"></a>
                <a href="#" class="fi-social-flickr"></a>
                <a href="#" class="fi-social-github"></a>
                <a href="#" class="fi-social-skype"></a>
                <a href="#" class="fi-social-snapchat"></a>
                <a href="#" class="fi-social-steam"></a>
                <a href="#" class="fi-social-xbox"></a>
                <a href="#" class="fi-social-reddit"></a> -->
                <a href="#" class="fi-rss"></a>
                <a href="#" class="fi-social-google-plus"></a>
                <a href="#" class="fi-social-youtube"></a>
                <a href="#" class="fi-social-twitter"></a>
                <a href="#" class="fi-social-facebook"></a>
            </div>
        </div>
    </div>
</header>

</div>


<div class="small-16 medium-16 large-12 columns main-column">
    

<main class="content" role="main">

    <article class="post tag-optimization tag-java tag-microcontainer tag-comparatif">


            <h1 class="post-title">Microcontainer distributions</h1>

            <span class="post-meta label"><time datetime="2019-08-15">15 Aug 2019</time></span>

            <section class="post-content">
                <h1 id="_goal" class="sect0">Goal</h1>
<div class="paragraph">
<p>Container must include minimal dependencies to run Java application (microservice or legacy application).</p>
</div>
<h1 id="_sizing" class="sect0">Sizing</h1>
<div class="paragraph">
<p>Creating a minimalist image will decrease size and improve performance to download it. It will also limit disk storage on docker registry and docker host (Layer duplication, automatic pull of base image).</p>
</div>
<div class="paragraph">
<p>The same service with less resources. (Ubuntu docker base image to alpine, Eclipse to distroless, Kubernetes to distroless)</p>
</div>
<h1 id="_security" class="sect0">Security</h1>
<div class="paragraph">
<p>NIST recommendation: "An image should only include the executable and libraries required by the app itself; all other OS functionality is provided by the OS kernel within the underlying host OS".</p>
</div>
<div class="paragraph">
<p>Attack surface vulnerability are limited.
Container immutability is guarantee (no manual connection into a container)
Secure secret variables unreachable (no remote connection, no shell, no exposition)</p>
</div>
<h1 id="_useful_tools" class="sect0">Useful Tools</h1>
<div class="paragraph">
<p>dive: image and layer size
ex: dive image_name</p>
</div>
<h1 id="_state_of_play" class="sect0">State of play</h1>
<div class="sect1">
<h2 id="_sizing_comparison">Sizing comparison</h2>
<div class="sectionbody">
<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=12271636&single=true" style="border:0px #ffffff none;" name="Distribution" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="500px" width="1000px" allowfullscreen></iframe>
<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubchart?oid=1977800902&format=interactive" style="border:0px #ffffff none;" name="Distribution" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="400px" width="1000px" allowfullscreen></iframe>
</div>
</div>
<h1 id="_strategies" class="sect0">Strategies</h1>
<div class="sect1">
<h2 id="_lightweight_distributions">Lightweight distributions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_base_image_comparison">Base image comparison</h3>
<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTlum2-EkQbcQiR0xuJAatsmiub8ky3MH8ZIjfVT-ZI6Iw2rwisZ9yolP1HPWhLX22afu22EVUUVLOd/pubhtml?gid=1361748970&single=true" style="border:0px #ffffff none;" name="Distribution" scrolling="no" frameborder="0" marginheight="0px" marginwidth="0px" height="900px" width="1100px" allowfullscreen></iframe>
<div class="sect3">
<h4 id="_distroless">Distroless</h4>
<div class="ulist">
<ul>
<li>
<p>support of Java 8 and 11</p>
</li>
<li>
<p>minimalist distribution</p>
</li>
<li>
<p>Custom packaging engine</p>
</li>
<li>
<p>glibc (for compatibility with old kernel)</p>
</li>
<li>
<p>debug image</p>
</li>
<li>
<p>Minimal attack surface</p>
</li>
<li>
<p>Quick update</p>
</li>
<li>
<p>Limited storage and networking</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_alpine">Alpine</h4>
<div class="ulist">
<ul>
<li>
<p>most common base image (possibility to use public image)</p>
</li>
<li>
<p>musl glibc ⇾ compatibility issue</p>
</li>
<li>
<p>java image add glibc</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_glibc_vs_musl_c">GLIBC vs musl c</h4>
<div class="ulist">
<ul>
<li>
<p>GLIBC: standard C library</p>
</li>
<li>
<p>musl c
<a href="http://www.musl-libc.org/faq.html" class="bare">http://www.musl-libc.org/faq.html</a>
Is musl compatible with glibc?
Yes and no. At both the source and binary level, musl aims for a degree of feature-compatibility, but not bug-compatibility, with glibc. When applications that work with glibc fail to compile against musl, the cause will usually be one of the following:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Assuming that including one header will cause symbols from another unrelated header to be exposed. This is an application bug, and fixing it is as simple as adding the missing #include directives.
Using implementation details from the glibc headers which were not meant to be exposed to applications. This is also an application bug, and it can usually be fixed by search-and-replace (e.g. replacing __pid_t with pid_t in the source).
Use of an interface that’s not implemented in musl. This can only be fixed by making the application’s use of the interface optional, or by extending musl to support the missing interface.
Binary compatibility is much more limited, but it will steadily increase with new versions of musl. At present, some glibc-linked shared libraries can be loaded with musl, but all but the simplest glibc-linked applications will fail if musl is dropped-in in place of /lib/ld-linux.so.2.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contains_optimization">Contains optimization</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>New paradigm, Container becomes a part of project packaging.</strong></p>
</div>
<div class="sect2">
<h3 id="_docker_slim_a_href_https_github_com_docker_slim_docker_slim_class_bare_https_github_com_docker_slim_docker_slim_a">Docker-slim: <a href="https://github.com/docker-slim/docker-slim" class="bare">https://github.com/docker-slim/docker-slim</a></h3>
<div class="ulist">
<ul>
<li>
<p>Since December 2014</p>
</li>
<li>
<p>8 contributors</p>
</li>
<li>
<p>Goal:  Don&#8217;t change anything in your Docker container image and minify it by up to 30x (and for compiled languages even more) making it secure too! (free and open source)
Examples
    Keystore
    Based on distroless
    quarkus-keystore-distroless 78.8MB</p>
<div class="literalblock">
<div class="content">
<pre>quarkus-keystore-disroless.slim 65.3MB</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Based on CentOS
quarkus-keystore-centos 248MB</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>quarkus-keystore-centos.slim 65.7MB</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Same target image size.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Keycloak Gatekeeper (Static binary)
Based on CentOS
rh-sso/keycloak-gatekeeper60 200 Mo</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>rh-sso/keycloak-gatekeeper60.slim 20 Mo :  d run -v /D/Developpement/archi/idm/keycloak-gatekeeper-test/config.yaml:/etc/keycloak-gatekeeper/config.yaml  rh-sso/keycloak-gatekeeper60.slim</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_security_2">Security</h4>
<div class="ulist">
<ul>
<li>
<p>selinux ?</p>
</li>
<li>
<p>seccomp</p>
</li>
<li>
<p>a CVE on image base does not always consequences to redeploy child image (CVE for curl but it&#8217;s removed by docker-slim &#8658; final image doesn&#8217;t change &#8658; deployment is no necessary ?)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_automation">Automation</h4>
<div class="paragraph">
<p>Run container for introspection on build. CI platform runs containers to containers</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_minicon_a_href_https_github_com_grycap_minicon_class_bare_https_github_com_grycap_minicon_a">Minicon <a href="https://github.com/grycap/minicon" class="bare">https://github.com/grycap/minicon</a></h3>
<div class="ulist">
<ul>
<li>
<p>Since November 2017</p>
</li>
<li>
<p>3 contributors</p>
</li>
<li>
<p>Goal: Reducing the footprint of one container is of special interest, to redistribute the container images.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Not tested because it&#8217;s the same tool as docker-slim but youngest and less supported.</strong></p>
</div>
</div>
</div>
</div>
                        <aside class="tags fi-pricetag-multiple">Posted on <a href="https://malys.github.io/tag/optimization/">optimization</a>, <a href="https://malys.github.io/tag/java/">java</a>, <a href="https://malys.github.io/tag/microcontainer/">microcontainer</a>, <a href="https://malys.github.io/tag/comparatif/">comparatif</a></aside>
            </section>
            <hr>
            <footer class="post-footer">

                <section class="share">
                    <h4>Liked this post ? Share it.</h4>
                    <a class="fi-social-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://malys.github.io/2019/08/15/Microcontainer-distributions.html"
                        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    </a>
                    <a class="fi-social-twitter" href="https://twitter.com/share?text=Microcontainer%20distributions&amp;url=https://malys.github.io/2019/08/15/Microcontainer-distributions.html"
                        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    </a>
                    <a class="fi-social-google-plus" href="https://plus.google.com/share?url=https://malys.github.io/2019/08/15/Microcontainer-distributions.html"
                       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    </a>
                </section>

                <section class="author">
                    <header>
                        <span>About the author</span>
                    </header>
                    <section>
                        <h4>Malys</h4>
                        <img src="https://avatars1.githubusercontent.com/u/463016?v&#x3D;4">
                        <span>Toulouse</span>
                        <a href="https://malys.github.io/">https://malys.github.io/</a>
                    </section>
                    <footer>
                         <p></p>
                    </footer>
                </section>

        <div class="clearfix"></div>
                    <hr>

            </footer>

        <h3 class="title-disqus"><span class="fi-comments"></span>Discussions</h3>
        <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'example'; // required: replace example with your forum shortname
    var disqus_identifier = ''; // make sure to use the post.id as an identifier, otherwise disqus will use the pages url per default, which might be problematic...
 
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </article>

</main>

</div>

</div>

    <!--[if lte IE 8]>
        <script type="text/javascript" src="//malys.github.io/themes/ichi_custom/assets/js/outdatedBrowser.min.js?v=1565615330365"></script>
    <![endif]-->
    <script type="text/javascript" src="//malys.github.io/themes/ichi_custom/assets/js/dest/built.min.js?v=1565615330365"></script>

    <script>
      $(document).foundation();
    </script>
</body>
</html>
