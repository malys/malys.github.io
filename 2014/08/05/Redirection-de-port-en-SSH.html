<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Redirection de port en SSH</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="//malys.github.io/themes/ichi/favicon.ico">

    <script type="text/javascript" src="//malys.github.io/themes/ichi/assets/js/vendor/fastclick.js?v=1.0.0"></script>
    <script type="text/javascript" src="//malys.github.io/themes/ichi/assets/js/vendor/modernizr.js?v=1.0.0"></script>


    <link rel="stylesheet" type="text/css" href="//malys.github.io/themes/ichi/assets/css/normalize.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//malys.github.io/themes/ichi/assets/css/foundation.min.css?v=1.0.0" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" type="text/css" href="//malys.github.io/themes/ichi/assets/css/outdatedBrowser.min.css?v=1.0.0">
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="//malys.github.io/themes/ichi/assets/fonts/foundation-icons/foundation-icons.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//malys.github.io/themes/ichi/assets/css/styles.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:300,700,400|Source+Sans+Pro:300,400,600,700,900,300italic,400italic,600italic,700italic,900italic" />

    <link rel="canonical" href="https://malys.github.io/2014/08/05/Redirection-de-port-en-SSH.html" />
    
    <meta property="og:site_name" content="Des outils et des développeurs..." />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Redirection de port en SSH" />
    <meta property="og:description" content="Définition La redirection de port ou port forwarding ou port mapping en anglais, consiste à rediriger des paquets réseaux reçus sur un port donné d&amp;#8217;un ordinateur ou un équipement réseau vers un autre ordinateur ou équipement réseau sur..." />
    <meta property="og:url" content="https://malys.github.io/2014/08/05/Redirection-de-port-en-SSH.html" />
    <meta property="article:published_time" content="2014-08-04T22:00:00.000Z" />
    <meta property="article:modified_time" content="2015-03-22T12:40:29.862Z" />
    <meta property="article:tag" content="SSH" />
    <meta property="article:tag" content="ProxMox" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Redirection de port en SSH" />
    <meta name="twitter:description" content="Définition La redirection de port ou port forwarding ou port mapping en anglais, consiste à rediriger des paquets réseaux reçus sur un port donné d&amp;#8217;un ordinateur ou un équipement réseau vers un autre ordinateur ou équipement réseau sur..." />
    <meta name="twitter:url" content="https://malys.github.io/2014/08/05/Redirection-de-port-en-SSH.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Des outils et des développeurs...",
    "author": {
        "@type": "Person",
        "image": "https://avatars.githubusercontent.com/u/463016?v=3",
        "url": "undefined/author/undefined"
    },
    "headline": "Redirection de port en SSH",
    "url": "https://malys.github.io/2014/08/05/Redirection-de-port-en-SSH.html",
    "datePublished": "2014-08-04T22:00:00.000Z",
    "dateModified": "2015-03-22T12:40:29.862Z",
    "keywords": "SSH, ProxMox",
    "description": "Définition La redirection de port ou port forwarding ou port mapping en anglais, consiste à rediriger des paquets réseaux reçus sur un port donné d&amp;#8217;un ordinateur ou un équipement réseau vers un autre ordinateur ou équipement réseau sur..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="Des outils et des développeurs..." href="https://malys.github.io/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
</head>
<body class="post-template tag-SSH tag-ProxMox">

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdate" href="http://outdatedbrowser.com/">Update my browser now</a></p>
</div>

<nav class="top-bar hide-for-large-up" data-topbar style="background: none">
  <ul class="title-area">
    <li class="name">

    </li>
    <li class="home"><a class="fi-home" href="https://malys.github.io"></a></li>
    <li class="toggle-topbar"><a href="#" id="trigger-overlay" class="fi-list"></a></li>
  </ul>

<div class="overlay overlay-scale">
    <button type="button" class="overlay-close">Close</button>
    <nav>
        <ul>
            <li><a href="https://malys.github.io">Home</a></li>
        </ul>
    </nav>
</div>

</nav>

<div class="row">

<div class="small-16 medium-16 large-4 columns right head-area bgimage" style="background-image: url(https://s3.amazonaws.com/durgatneogi/52773250b465babd24000217_cover)">

<header class="site-head">
    <div class="vertical">
        <div class="site-head-content inner">
            <ul class="side-nav blog-menu show-for-large-up">
                <li><a class="fi-home" href="https://malys.github.io"></a></li>
                <li><a class="fi-torso" href="https://malys.github.io/about"></a></li>
                <li><a class="fi-mail" href="https://malys.github.io/contact"></a></li>
            </ul>
            <a class="blog-logo" href="https://malys.github.io"><img alt="Des outils et des développeurs..." src="https://www.gravatar.com/avatar/c738c1bff9731c9cf6dccd5cc1270e94.png" alt="Blog Logo" /></a>
            <h1 class="blog-title">Des outils et des développeurs...</h1>
            <hr>
            <p class="blog-description">Astuces et conseils concernant les outils qui peuvent égailler le quotidien d&#x27;un développeur :)

</p>
            <div class="blog-network">
<!--                 <a href="#" class="fi-social-pinterest"></a>
                <a href="#" class="fi-social-linkedin"></a>
                <a href="#" class="fi-social-behance"></a>
                <a href="#" class="fi-social-deviant-art"></a>
                <a href="#" class="fi-social-dribbble"></a>
                <a href="#" class="fi-social-flickr"></a>
                <a href="#" class="fi-social-github"></a>
                <a href="#" class="fi-social-skype"></a>
                <a href="#" class="fi-social-snapchat"></a>
                <a href="#" class="fi-social-steam"></a>
                <a href="#" class="fi-social-xbox"></a>
                <a href="#" class="fi-social-reddit"></a> -->
                  <a href="https://github.com/malys/" class="fi-social-github"></a>
            </div>
        </div>
    </div>
</header>

</div>


<div class="small-16 medium-16 large-12 columns main-column left">
    

<main class="content" role="main">

    <article class="post tag-SSH tag-ProxMox">


            <h1 class="post-title">Redirection de port en SSH</h1>

            <span class="post-meta label"><time datetime="2014-08-05">05 Aug 2014</time></span>

            <section class="post-content">
                <div class="sect1">
<h2 id="_d_finition">Définition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>La redirection de port ou port forwarding ou port mapping en anglais, consiste à rediriger des paquets réseaux reçus sur un port donné d&#8217;un ordinateur ou un équipement réseau vers un autre ordinateur ou équipement réseau sur un port donné. Cela permet entre autres de proposer à des ordinateurs extérieurs à un réseau d&#8217;accéder à des services répartis sur plusieurs ordinateurs de ce réseau. Voir <a href="http://fr.wikipedia.org/wiki/Redirection_de_port">Wikipedia</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_objectif">Objectif</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nous souhaitons via une connexion SSH comsommer des services hébergées en local et des services locaux à distance</p>
</div>
<div class="paragraph">
<p>Dans notre cas, nous aurons un serveur Proxmox qui mettra à disposition des containers ou des machines virtuelles.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/portforwarding.png" alt="portforwarding.png"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_redirection_de_port">Redirection de port</h2>
<div class="sectionbody">
<div class="sect3">
<h4 id="_putty">Putty</h4>
<div class="paragraph">
<p>Dans ce cas, nous voulons avoir accès au port 80 de la VM sous CentOS avec le serveur web.</p>
</div>
<div class="paragraph">
<p>Pour cela, nous devons créer un tunnel SSH. Dans notre cas, nous utiliserons Putty comme client SSH (les commandes ssh sous Windows ou Linux sont quasiment identiques).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/Putty1.png" alt="img"></span></p>
</div>
<div class="paragraph">
<p>et configurer le tunnel dans SSH/Tunnels</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/Putty2.png" alt="img"></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Source Port : le port local à votre poste sur lequel le service web distant sera accessible

Destination: IP Locale de la VM:Port à rediriger

Local: Permet de définir le sens de la redirection du port dans ce cas là distant -&gt; local</code></pre>
</div>
</div>
<div class="paragraph">
<p>Il faut sauvegarder la configuration.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/Putty3.png" alt="img"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_ligne_de_commande">Ligne de commande</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">plink.exe -ssh proxmoxPublicIP -P 22 -l user -L 8080:CentOSLocalIP:80 -N</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>-N</strong> permet d&#8217;ouvrir exclusivement le tunnel sans ouvrir la console.</p>
</div>
<div class="paragraph">
<p><strong>-L</strong> peuvent être multiple pour ajouter autant de port que vous souhaitez</p>
</div>
<div class="paragraph">
<p>Exemples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">rem HTTP
plink.exe -ssh proxmoxPublicIP -P 22 -l user -L 8080:CentOSLocalIP:80 -N</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">rem RDP Bureau distant Windows
plink.exe -ssh proxmoxPublicIP -P 22 -l user -L 33389:CentOSLocalIP:3389 -N</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utilisation">Utilisation</h4>
<div class="paragraph">
<p>Ouvrons sur votre poste votre navigateur préféré à l&#8217;adresse suivante:
<strong><a href="http://localhost:8080" class="bare">http://localhost:8080</a></strong></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_redirection_inverse_de_port">Redirection inverse de port</h2>
<div class="sectionbody">
<div class="sect3">
<h4 id="_putty_2">Putty</h4>
<div class="paragraph">
<p>Dans ce cas, nous voulons avoir accès au port 80 de notre poste sur le serveur Windows 2003 avec IE8.
Nous pourrons alors tester notre site web avec IE8 par exemple.</p>
</div>
<div class="paragraph">
<p>Pour cela, nous devons créer un tunnel SSH. Nous allons utliser celui que nous avons précédemment configuré.</p>
</div>
<div class="paragraph">
<p>Configurons le tunnel dans SSH/Tunnels</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/Putty4.png" alt="img"></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">Source Port : le port local au serveur Win 2003 sur lequel votre site web sera accessible

Destination: IP Locale de votre poste sur lequel le serveur web écoute

Remote: Permet de définir le sens de la redirection du port dans ce cas là  local -&gt; distant</code></pre>
</div>
</div>
<div class="paragraph">
<p>Il faut sauvegarder la configuration.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/Putty3.png" alt="img"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_ligne_de_commande_2">Ligne de commande</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">plink.exe -ssh proxmoxPublicIP -P 22 -l user -R *:1080:localhost:80 -N</code></pre>
</div>
</div>
<div class="paragraph">
<p>\*:1080 permet de préciser que ce port sera accessible pour toutes les interfaces réseaux.</p>
</div>
<div class="paragraph">
<p>-R peuvent être multiple pour ajouter autant de port que vous souhaitez.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_du_serveur_ssh">Configuration du serveur SSH</h4>
<div class="paragraph">
<p>Il faut préciser au serveur proxmox que le port redirigé sera accessible sur toutes les interfaces si le client le demande (<strong>*:1080</strong> de la ligne de commande)</p>
</div>
<div class="paragraph">
<p>Sur le serveur Proxmox,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo nano /etc/ssh/sshd_config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ajouter la ligne et sauvegarder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">Match User `user`
   GatewayPorts yes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Recharger la configuration du serveur SSH</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">/etc/init.d/ssh reload</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utilisation_2">Utilisation</h4>
<div class="paragraph">
<p>Ouvrons sur le serveur Win 2003 avec IE8 l&#8217;adresse suivante:</p>
</div>
<div class="paragraph">
<p><strong><a href="http://IpLocaleServeurProxmox:8080" class="bare">http://IpLocaleServeurProxmox:8080</a></strong></p>
</div>
<div class="paragraph">
<p>Exemple:</p>
</div>
<div class="paragraph">
<p><strong><a href="http://192.168.0.254:8080" class="bare">http://192.168.0.254:8080</a></strong></p>
</div>
<div class="paragraph">
<p>Avec le bridge Proxmox configuré ainsi:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/images/Putty5.png" alt="img"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_ressources">Ressources</h4>
<div class="paragraph">
<p><a href="http://askubuntu.com/questions/50064/reverse-port-tunnelling">Reverse Forwarding</a></p>
</div>
<div class="paragraph">
<p><a href="http://www.cyberciti.biz/faq/howto-restart-ssh/">Reload SSH</a></p>
</div>
<div class="paragraph">
<p><a href="http://marc.terrier.free.fr/docputty/Chapter3.html==using-cmdline">Tutoriel Putty</a></p>
</div>
<div class="paragraph">
<p><a href="http://serverfault.com/questions/387772/ssh-reverse-port-forwarding-with-putty-how-to-specify-bind-address">Check Reverse Port Forwarding</a></p>
</div>
</div>
</div>
</div>
                        <aside class="tags fi-pricetag-multiple">Posted on <a href="https://malys.github.io/tag/SSH">SSH</a>, <a href="https://malys.github.io/tag/ProxMox">ProxMox</a></aside>
            </section>
            <hr>
            <footer class="post-footer">

                <section class="share">
                    <h4>Liked this post ? Share it.</h4>
                    <a class="fi-social-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://malys.github.io/2014/08/05/Redirection-de-port-en-SSH.html"
                        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    </a>
                    <a class="fi-social-twitter" href="https://twitter.com/share?text=Redirection%20de%20port%20en%20SSH&amp;url=https://malys.github.io/2014/08/05/Redirection-de-port-en-SSH.html"
                        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    </a>
                    <a class="fi-social-google-plus" href="https://plus.google.com/share?url=https://malys.github.io/2014/08/05/Redirection-de-port-en-SSH.html"
                       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    </a>
                </section>

                <section class="author">
                    <header>
                        <span>About the author</span>
                    </header>
                    <section>
                        <h4></h4>
                        <img src="https://avatars.githubusercontent.com/u/463016?v=3">
                        
                        
                    </section>
                    <footer>
                         <p></p>
                    </footer>
                </section>

        <div class="clearfix"></div>
                    <hr>

            </footer>

        <h3 class="title-disqus"><span class="fi-comments"></span>Discussions</h3>




        <section class="post-comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          var disqus_shortname = 'malysblog'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>


    </article>

</main>

</div>

</div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>

    <!--[if lte IE 8]>
        <script type="text/javascript" src="//malys.github.io/themes/ichi/assets/js/outdatedBrowser.min.js?v=1.0.0"></script>
    <![endif]-->
    <script type="text/javascript" src="//malys.github.io/themes/ichi/assets/js/min/built.js?v=1.0.0"></script>

    <script>
      $(document).foundation();
    </script>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60775657-1', 'auto');
    ga('send', 'pageview');

    </script>
</body>
</html>
